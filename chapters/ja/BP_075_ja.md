## データベースクエリの最適化

### 識別子

| GreenIT |  V2  |  V3  |  V4  |
|:-------:|:----:|:----:|:----:|
|  59    | 74  | 75  |      |

### カテゴリ

| ライフサイクル |  サードパーティ  |  担当者  |
|:---------:|:----:|:----:|
| 3. 実現 (製造 / 実装) | データセンター | ソフトウェアアーキテクト/開発者 |

### 効果

| 優先度 |      実装難易度       |  エコロジーへの影響度    |
|:-------------------:|:-------------------------:|:---------------------:|
| 3 | 3 | 3 |

|リソース                                      |
|:----------------------------------------------------------:|
| プロセッサ  / RAM / ネットワーク   |

### 説明

データベースは一般的にアプリケーションの重要な構成要素であり、データを取得および保存するための多くのリクエストが頻繁に実行されます。これにより、ソリューションのリソース使用量に大きな影響を与えます。

この観点から、これらのリクエストに注意を払い、特にコストが高いものについては、しっかりと最適化されているかを確認することが重要です。

一般的な最適化の手法は以下のとおりです : 

 - 必要最低限のデータのみを取得する。例えば、リレーショナルデータベースにおいては、LIMIT句が結果の行数を制限します。可能な場合、これを使用すると、転送されるデータ量が減少します。特にレコードが多くの大きなフィールドを含む場合、パフォーマンスの向上が顕著です。
 - 使用するテーブルやドキュメントで必要なフィールドのみを使用する。これにより、不必要なデータを転送しないで済みます。
 - キーとして使用されるフィールドにインデックスを追加する。これはモデルに依存しますが、インデックスの追加によって、リクエストのパフォーマンスが大幅に向上する場合があります。ただし、インデックスを追加すると、書き込みが遅くなる可能性があります。
 - データベース管理システムのツールを使用して、リクエストを分析し、改善点を特定する。例えば、RDBMSではEXPLAINが使用されます。
 - コストが高いリクエストの結果、および少ないまたはまったく変更されないデータ（参照データ）をキャッシュに保存する。
 - 必要に応じて、データモデルを変更して、結合なしで情報に容易にアクセスできるようにする（非正規化）。

### 例

まず、LIMIT句を使った例です :

人々の名前と姓を含むテーブルから最初の25レコードのみを表示したい場合、選択時に以下のように変更します :
```sql
SELECT prenom, nom FROM personnes
```
を :
```sql
SELECT prenom, nom FROM personnes LIMIT 0, 25
```

に変更。

もう1つの例は、インデックスの作成です : 

```sql
CREATE INDEX idx_personnes_nom_prenom ON personnes(nom, prenom)
```

このコマンドにより、データベース管理システムはpersonnesの行を（名前、姓）の情報からより迅速に見つけることができます。


### 検証原理

| 検証項目     | 次の値以下である   |  
|-------------------|:-------------------------:|
| 最適化されていない低パフォーマンスなリクエストの数 | 0  |
